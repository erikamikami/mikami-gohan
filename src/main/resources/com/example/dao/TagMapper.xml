<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.dao.TagMapper">
<select id="getTopTenTags" resultType="com.example.entity.Tag">
SELECT t.id as id, t.tag_name as tag_name
FROM (
    SELECT tag_1 AS tag_id FROM recipe WHERE tag_1 IS NOT NULL
    UNION ALL
    SELECT tag_2 FROM recipe WHERE tag_2 IS NOT NULL
    UNION ALL
    SELECT tag_3 FROM recipe WHERE tag_3 IS NOT NULL
    UNION ALL
    SELECT tag_4 FROM recipe WHERE tag_4 IS NOT NULL
    UNION ALL
    SELECT tag_5 FROM recipe WHERE tag_5 IS NOT NULL
) r
JOIN tag t ON t.id = r.tag_id
GROUP BY t.id, t.tag_name
ORDER BY COUNT(*) DESC
LIMIT 10;
</select>

</mapper>